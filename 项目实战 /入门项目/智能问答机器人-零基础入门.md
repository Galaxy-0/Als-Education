# æ™ºèƒ½é—®ç­”æœºå™¨äºº - é›¶åŸºç¡€å…¥é—¨é¡¹ç›®

> æœ¬æ•™ç¨‹é¢å‘é›¶ç¼–ç¨‹åŸºç¡€çš„å¼€å‘è€…ï¼Œé€šè¿‡ç®€å•æ­¥éª¤æ„å»ºä½ çš„ç¬¬ä¸€ä¸ªAIåº”ç”¨ï¼šä¸€ä¸ªæ™ºèƒ½é—®ç­”æœºå™¨äººã€‚

## é¡¹ç›®æ¦‚è¿°

åœ¨è¿™ä¸ªå…¥é—¨é¡¹ç›®ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•ï¼š
1. é…ç½®å¼€å‘ç¯å¢ƒ
2. è·å–å¹¶ä½¿ç”¨OpenAI APIå¯†é’¥
3. æ„å»ºä¸€ä¸ªç®€å•çš„é—®ç­”æœºå™¨äºº
4. æ·»åŠ åŸºæœ¬çš„Webç•Œé¢
5. è¿›è¡Œç®€å•è‡ªå®šä¹‰å’Œä¼˜åŒ–

å®Œæˆåï¼Œä½ å°†æ‹¥æœ‰ä¸€ä¸ªå¯ä»¥å›ç­”å„ç§é—®é¢˜çš„æ™ºèƒ½é—®ç­”æœºå™¨äººï¼Œå¹¶ä¸”ç†è§£æ„å»ºAIåº”ç”¨çš„åŸºæœ¬æµç¨‹ã€‚

## é¢„è®¡æ—¶é—´
* ç¯å¢ƒé…ç½®ï¼š30åˆ†é’Ÿ
* ä»£ç ç¼–å†™ï¼š1å°æ—¶
* è‡ªå®šä¹‰ä¸ä¼˜åŒ–ï¼š30åˆ†é’Ÿ

## é¢„å¤‡çŸ¥è¯†
* åŸºæœ¬çš„è®¡ç®—æœºæ“ä½œèƒ½åŠ›
* ç®€å•çš„ç»ˆç«¯/å‘½ä»¤è¡Œä½¿ç”¨
* æ— éœ€ç¼–ç¨‹ç»éªŒï¼

## å¼€å‘ç¯å¢ƒè®¾ç½®

### ç¬¬1æ­¥ï¼šå®‰è£…Python

1. è®¿é—® [Pythonå®˜ç½‘](https://www.python.org/downloads/) ä¸‹è½½æœ€æ–°ç‰ˆPython (3.8æˆ–æ›´é«˜ç‰ˆæœ¬)
2. è¿è¡Œå®‰è£…ç¨‹åºï¼Œ**åŠ¡å¿…å‹¾é€‰"Add Python to PATH"é€‰é¡¹**
3. å®‰è£…å®Œæˆåï¼Œæ‰“å¼€ç»ˆç«¯æˆ–å‘½ä»¤æç¤ºç¬¦ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤éªŒè¯å®‰è£…ï¼š
```bash
python --version
```
åº”è¯¥æ˜¾ç¤ºPythonç‰ˆæœ¬å·ï¼Œä¾‹å¦‚ `Python 3.9.5`

### ç¬¬2æ­¥ï¼šåˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹

1. åœ¨ä½ å–œæ¬¢çš„ä½ç½®åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚ `ai_chatbot`
2. æ‰“å¼€ç»ˆç«¯/å‘½ä»¤æç¤ºç¬¦ï¼Œå¯¼èˆªåˆ°è¯¥æ–‡ä»¶å¤¹ï¼š
```bash
# Windows
cd C:\path\to\ai_chatbot

# Mac/Linux
cd /path/to/ai_chatbot
```

### ç¬¬3æ­¥ï¼šè®¾ç½®è™šæ‹Ÿç¯å¢ƒï¼ˆå¯é€‰ä½†æ¨èï¼‰

è™šæ‹Ÿç¯å¢ƒå¯ä»¥éš”ç¦»é¡¹ç›®ä¾èµ–ï¼Œæ˜¯Pythonå¼€å‘çš„æœ€ä½³å®è·µã€‚

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows
venv\Scripts\activate

# Mac/Linux
source venv/bin/activate
```

æ¿€æ´»åï¼Œå‘½ä»¤è¡Œå‰é¢åº”è¯¥ä¼šå‡ºç° `(venv)` å‰ç¼€ã€‚

### ç¬¬4æ­¥ï¼šå®‰è£…å¿…è¦çš„åº“

```bash
pip install openai streamlit python-dotenv
```

## è·å–APIå¯†é’¥

### ç¬¬1æ­¥ï¼šæ³¨å†ŒOpenAIè´¦å·

1. è®¿é—® [OpenAI](https://beta.openai.com/signup) ç½‘ç«™æ³¨å†Œè´¦å·
2. å®Œæˆé‚®ç®±éªŒè¯å’Œæ‰‹æœºéªŒè¯

### ç¬¬2æ­¥ï¼šåˆ›å»ºAPIå¯†é’¥

1. ç™»å½•åï¼Œç‚¹å‡»å³ä¸Šè§’å¤´åƒå›¾æ ‡ï¼Œé€‰æ‹© "API Keys"
2. ç‚¹å‡» "Create new secret key"
3. ä¸ºå¯†é’¥æ·»åŠ ä¸€ä¸ªæè¿°ï¼ˆä¾‹å¦‚ "AIèŠå¤©æœºå™¨äºº"ï¼‰
4. å¤åˆ¶ç”Ÿæˆçš„APIå¯†é’¥ï¼Œå¹¶ä¿å­˜åœ¨å®‰å…¨çš„åœ°æ–¹ï¼ˆ**æ³¨æ„ï¼šè¿™ä¸ªå¯†é’¥åªä¼šæ˜¾ç¤ºä¸€æ¬¡**ï¼‰

### ç¬¬3æ­¥ï¼šå­˜å‚¨APIå¯†é’¥

åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º `.env` çš„æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```
OPENAI_API_KEY=ä½ çš„APIå¯†é’¥
```

æ³¨æ„ï¼š`.env` æ–‡ä»¶ä¸åº”æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆä¾‹å¦‚Gitï¼‰ä¸­ã€‚

## æ„å»ºåŸºç¡€é—®ç­”æœºå™¨äºº

### ç¬¬1æ­¥ï¼šåˆ›å»ºä¸»ç¨‹åºæ–‡ä»¶

åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º `chatbot.py` çš„æ–‡ä»¶ï¼Œè¾“å…¥ä»¥ä¸‹ä»£ç ï¼š

```python
import os
from dotenv import load_dotenv
import openai

# åŠ è½½ç¯å¢ƒå˜é‡
load_dotenv()

# è®¾ç½®OpenAI APIå¯†é’¥
openai.api_key = os.getenv("OPENAI_API_KEY")

def ask_question(question):
    """å‘OpenAI APIå‘é€é—®é¢˜å¹¶è·å–å›ç­”"""
    try:
        # è°ƒç”¨ChatGPT API
        response = openai.ChatCompletion.create(
            model="gpt-3.5-turbo",  # ä½¿ç”¨è¾ƒç»æµçš„æ¨¡å‹
            messages=[
                {"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªä¹äºåŠ©äººçš„æ™ºèƒ½åŠ©æ‰‹ã€‚"},
                {"role": "user", "content": question}
            ],
            max_tokens=500,  # é™åˆ¶å›ç­”é•¿åº¦
            temperature=0.7  # æ§åˆ¶å›ç­”çš„åˆ›é€ æ€§ï¼Œè¾ƒä½å€¼ä½¿å›ç­”æ›´ç¡®å®š
        )
        
        # æå–å›ç­”å†…å®¹
        answer = response.choices[0].message['content'].strip()
        return answer
    
    except Exception as e:
        return f"æŠ±æ­‰ï¼Œå‘ç”Ÿäº†é”™è¯¯: {str(e)}"

# ç®€å•çš„å‘½ä»¤è¡Œç•Œé¢
if __name__ == "__main__":
    print("æ¬¢è¿ä½¿ç”¨AIé—®ç­”æœºå™¨äººï¼è¾“å…¥'é€€å‡º'ç»“æŸå¯¹è¯ã€‚")
    
    while True:
        user_question = input("\nè¯·è¾“å…¥æ‚¨çš„é—®é¢˜: ")
        
        if user_question.lower() in ['é€€å‡º', 'exit', 'quit']:
            print("è°¢è°¢ä½¿ç”¨ï¼Œå†è§ï¼")
            break
        
        print("\nAIæ€è€ƒä¸­...")
        answer = ask_question(user_question)
        print(f"\nAIå›ç­”: {answer}")
```

### ç¬¬2æ­¥ï¼šæµ‹è¯•å‘½ä»¤è¡Œç‰ˆæœ¬

åœ¨ç»ˆç«¯/å‘½ä»¤æç¤ºç¬¦ä¸­è¿è¡Œç¨‹åºï¼š

```bash
python chatbot.py
```

è¾“å…¥ä¸€äº›é—®é¢˜æµ‹è¯•æœºå™¨äººçš„å›ç­”èƒ½åŠ›ã€‚è¾“å…¥"é€€å‡º"ç»“æŸç¨‹åºã€‚

## æ·»åŠ Webç•Œé¢

### ç¬¬1æ­¥ï¼šåˆ›å»ºStreamlitåº”ç”¨

åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º `app.py` çš„æ–‡ä»¶ï¼Œè¾“å…¥ä»¥ä¸‹ä»£ç ï¼š

```python
import streamlit as st
from chatbot import ask_question

# è®¾ç½®é¡µé¢æ ‡é¢˜
st.set_page_config(page_title="AIé—®ç­”æœºå™¨äºº")

# é¡µé¢æ ‡é¢˜
st.title("æ™ºèƒ½é—®ç­”æœºå™¨äºº")
st.write("ğŸ‘‹ ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„AIåŠ©æ‰‹ï¼Œè¯·è¾“å…¥ä»»ä½•é—®é¢˜ã€‚")

# åˆå§‹åŒ–èŠå¤©å†å²
if "messages" not in st.session_state:
    st.session_state.messages = []

# æ˜¾ç¤ºèŠå¤©å†å²
for message in st.session_state.messages:
    with st.chat_message(message["role"]):
        st.markdown(message["content"])

# è¾“å…¥æ¡†
if prompt := st.chat_input("è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..."):
    # å°†ç”¨æˆ·é—®é¢˜æ·»åŠ åˆ°èŠå¤©å†å²
    st.session_state.messages.append({"role": "user", "content": prompt})
    
    # æ˜¾ç¤ºç”¨æˆ·é—®é¢˜
    with st.chat_message("user"):
        st.markdown(prompt)
    
    # æ˜¾ç¤ºAIæ€è€ƒä¸­çš„çŠ¶æ€
    with st.chat_message("assistant"):
        message_placeholder = st.empty()
        message_placeholder.markdown("æ€è€ƒä¸­...")
        
        # è·å–AIå›ç­”
        response = ask_question(prompt)
        
        # æ›´æ–°æ˜¾ç¤ºå†…å®¹
        message_placeholder.markdown(response)
    
    # å°†AIå›ç­”æ·»åŠ åˆ°èŠå¤©å†å²
    st.session_state.messages.append({"role": "assistant", "content": response})
```

### ç¬¬2æ­¥ï¼šè¿è¡ŒWebåº”ç”¨

åœ¨ç»ˆç«¯/å‘½ä»¤æç¤ºç¬¦ä¸­è¿è¡ŒStreamlitåº”ç”¨ï¼š

```bash
streamlit run app.py
```

è¿™å°†å¯åŠ¨ä¸€ä¸ªæœ¬åœ°WebæœåŠ¡å™¨ï¼Œå¹¶è‡ªåŠ¨åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€åº”ç”¨ã€‚

## è‡ªå®šä¹‰ä¸ä¼˜åŒ–

ä»¥ä¸‹æ˜¯ä¸€äº›ç®€å•çš„è‡ªå®šä¹‰é€‰é¡¹ï¼Œä½ å¯ä»¥å°è¯•ä¿®æ”¹ä»£ç ä»¥å®ç°ï¼š

### è°ƒæ•´æœºå™¨äººä¸ªæ€§

åœ¨ `chatbot.py` æ–‡ä»¶ä¸­ï¼Œä¿®æ”¹ç³»ç»Ÿæç¤ºä»¥æ”¹å˜AIçš„ä¸ªæ€§ï¼š

```python
# ä¾‹å¦‚ï¼Œæ”¹æˆä¸“å®¶é£æ ¼
{"role": "system", "content": "ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„å’¨è¯¢é¡¾é—®ï¼Œæ“…é•¿ç»™å‡ºæ¸…æ™°ã€ç³»ç»Ÿçš„å»ºè®®ã€‚"}

# æˆ–æ”¹æˆå‹å¥½é£æ ¼
{"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªå‹å¥½çš„åŠ©æ‰‹ï¼Œå–œæ¬¢ç”¨ç®€å•æ˜“æ‡‚çš„è¯­è¨€å›ç­”é—®é¢˜ï¼Œå¹¶ç»å¸¸ä½¿ç”¨ä¾‹å­æ¥è§£é‡Šã€‚"}
```

### æ·»åŠ ä¸Šä¸‹æ–‡è®°å¿†

åœ¨ `chatbot.py` ä¸­ä¿®æ”¹ `ask_question` å‡½æ•°ï¼Œæ·»åŠ å¯¹è¯å†å²ï¼š

```python
def ask_question(question, history=None):
    """å‘OpenAI APIå‘é€é—®é¢˜å¹¶è·å–å›ç­”ï¼Œæ”¯æŒå¯¹è¯å†å²"""
    messages = [{"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªä¹äºåŠ©äººçš„æ™ºèƒ½åŠ©æ‰‹ã€‚"}]
    
    # æ·»åŠ å†å²æ¶ˆæ¯ï¼ˆå¦‚æœæœ‰ï¼‰
    if history:
        messages.extend(history)
    
    # æ·»åŠ å½“å‰é—®é¢˜
    messages.append({"role": "user", "content": question})
    
    try:
        # è°ƒç”¨ChatGPT API
        response = openai.ChatCompletion.create(
            model="gpt-3.5-turbo",
            messages=messages,
            max_tokens=500,
            temperature=0.7
        )
        
        answer = response.choices[0].message['content'].strip()
        return answer
    
    except Exception as e:
        return f"æŠ±æ­‰ï¼Œå‘ç”Ÿäº†é”™è¯¯: {str(e)}"
```

ç„¶ååœ¨ `app.py` ä¸­é€‚å½“ä¿®æ”¹ä»£ç ï¼Œå°†æ•´ä¸ªå¯¹è¯å†å²ä¼ é€’ç»™å‡½æ•°ã€‚

### æ·»åŠ æ¸©åº¦æ§åˆ¶

åœ¨Webç•Œé¢ä¸­æ·»åŠ ä¸€ä¸ªæ»‘å—ï¼Œè®©ç”¨æˆ·è°ƒæ•´AIå›ç­”çš„åˆ›é€ æ€§ï¼š

```python
# åœ¨app.pyä¸­æ·»åŠ 
temperature = st.slider("å›ç­”åˆ›é€ æ€§", min_value=0.0, max_value=1.0, value=0.7, step=0.1, 
                        help="è¾ƒä½å€¼ä½¿å›ç­”æ›´ç¡®å®šï¼Œè¾ƒé«˜å€¼ä½¿å›ç­”æ›´åˆ›é€ æ€§")

# ä¿®æ”¹è·å–å›ç­”çš„éƒ¨åˆ†
response = ask_question(prompt, temperature=temperature)

# ç„¶åä¿®æ”¹ask_questionå‡½æ•°æ¥å—temperatureå‚æ•°
def ask_question(question, temperature=0.7, history=None):
    # ...
    response = openai.ChatCompletion.create(
        # ...
        temperature=temperature
    )
    # ...
```

## ä¸‹ä¸€æ­¥

æ­å–œï¼ä½ å·²ç»æˆåŠŸæ„å»ºäº†ä¸€ä¸ªæ™ºèƒ½é—®ç­”æœºå™¨äººã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¯ä»¥è¿›ä¸€æ­¥æ¢ç´¢çš„æ–¹å‘ï¼š

1. **æ·»åŠ è¯­éŸ³è¾“å…¥/è¾“å‡º**ï¼šé›†æˆè¯­éŸ³è¯†åˆ«å’ŒåˆæˆåŠŸèƒ½
2. **å®šåˆ¶çŸ¥è¯†é¢†åŸŸ**ï¼šé€šè¿‡æç¤ºå·¥ç¨‹è®©æœºå™¨äººä¸“æ³¨äºç‰¹å®šé¢†åŸŸ
3. **æ·»åŠ æ–‡ä»¶å¤„ç†**ï¼šè®©æœºå™¨äººèƒ½å¤Ÿåˆ†æä¸Šä¼ çš„æ–‡ä»¶å†…å®¹
4. **éƒ¨ç½²åˆ°äº‘å¹³å°**ï¼šå°†åº”ç”¨éƒ¨ç½²åˆ°Streamlit Cloudæˆ–å…¶ä»–å¹³å°
5. **å¢åŠ å¤šè½®å¯¹è¯èƒ½åŠ›**ï¼šä¼˜åŒ–å¯¹è¯å†å²ç®¡ç†ï¼Œå®ç°æ›´è‡ªç„¶çš„å¤šè½®å¯¹è¯

## å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### APIå¯†é’¥é—®é¢˜

**é—®é¢˜**: æ”¶åˆ°"Authentication Error"æˆ–æ— æ³•è¿æ¥APIã€‚
**è§£å†³æ–¹æ¡ˆ**: 
- æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡®å¤åˆ¶
- ç¡®è®¤`.env`æ–‡ä»¶åœ¨æ­£ç¡®ä½ç½®ä¸”æ ¼å¼æ— è¯¯
- æ£€æŸ¥OpenAIè´¦æˆ·ä½™é¢

### é€Ÿåº¦ä¼˜åŒ–

**é—®é¢˜**: APIå“åº”è¾ƒæ…¢ã€‚
**è§£å†³æ–¹æ¡ˆ**:
- é™ä½`max_tokens`å€¼
- ä½¿ç”¨æ›´å°çš„æ¨¡å‹å¦‚"gpt-3.5-turbo"ä»£æ›¿"gpt-4"
- æ·»åŠ ç¼“å­˜æœºåˆ¶é¿å…é‡å¤é—®é¢˜é‡å¤è°ƒç”¨API

### é”™è¯¯å¤„ç†

æ·»åŠ æ›´å¥å£®çš„é”™è¯¯å¤„ç†ï¼Œåœ¨APIè°ƒç”¨å¤±è´¥æ—¶æä¾›å‹å¥½çš„ç”¨æˆ·ä½“éªŒï¼š

```python
try:
    # APIè°ƒç”¨ä»£ç 
except openai.error.RateLimitError:
    return "æŠ±æ­‰ï¼ŒæœåŠ¡å™¨æ­£å¿™ï¼Œè¯·ç¨åå†è¯•ã€‚"
except openai.error.AuthenticationError:
    return "APIå¯†é’¥éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥è®¾ç½®ã€‚"
except openai.error.APIError:
    return "OpenAIæœåŠ¡å‡ºç°é—®é¢˜ï¼Œè¯·ç¨åå†è¯•ã€‚"
except Exception as e:
    return f"å‘ç”ŸæœªçŸ¥é”™è¯¯: {str(e)}"
```

---

è®°ä½ï¼ŒAIåº”ç”¨å¼€å‘æ˜¯ä¸€ä¸ªä¸æ–­å­¦ä¹ çš„è¿‡ç¨‹ã€‚ä»è¿™ä¸ªç®€å•çš„é¡¹ç›®å¼€å§‹ï¼Œä½ å¯ä»¥é€æ­¥æ¢ç´¢æ›´å¤æ‚çš„åŠŸèƒ½å’Œåº”ç”¨åœºæ™¯ã€‚ç¥ä½ å¼€å‘æ„‰å¿«ï¼ 